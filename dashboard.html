<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informācijas panelis</title>
    <style>
        body { font-family: Arial, sans-serif; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 8px; border: 1px solid #ddd; text-align: left; }
        th { background-color: #f2f2f2; }
        input { width: 100%; border: none; padding: 6px; box-sizing: border-box; }
        input:focus { outline: 1px solid #007bff; }
        .action-buttons { display: flex; gap: 8px; }
        .add-row-btn { margin-top: 10px; padding: 6px 12px; background-color: #28a745; color: #fff; border: none; cursor: pointer; }
        .save-btn { background-color: #007bff; color: #fff; border: none; padding: 6px 12px; cursor: pointer; }
        .delete-btn { background-color: #dc3545; color: #fff; border: none; padding: 6px 12px; cursor: pointer; }
    </style>
</head>
<body>

<h1>Informācijas panelis</h1>

<table id="data-table">
    <thead>
        <tr>
            <th>Pašvaldība</th>
            <th>Pabalsts bērna uzturam līdz 7 g.v.</th>
            <th>pabalsts bērna uzturam 7-18g.v.</th>
            <th>apģērba un mīkstā inventāra ievietojot</th>
            <th>Biežums</th>
            <th>Mācību materiāli</th>
            <th>Bērna izglītībai un audzināšanai</th>
            <th>Papildus atbalsts audžuģimenei</th>
            <th>Citi</th>
            <th>Darbība</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<!-- Button to add new row -->
<button class="add-row-btn" onclick="addRow()">Pievienot rindu</button>

<script>
    let data = [];
    
    // Load data from server
    function loadData() {
        fetch('/data')
            .then(response => response.json())
            .then(jsonData => {
                data = jsonData;
                renderTable();
            });
    }
    
    // Render table with data
    function renderTable() {
        const tbody = document.querySelector('#data-table tbody');
        tbody.innerHTML = '';
    
        data.forEach((item, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="text" value="${item.Municipality}" oninput="updateData(${index}, 'Municipality', this.value)"></td>
                <td><input type="text" value="${item.Support_Under_7}" oninput="updateData(${index}, 'Support_Under_7', this.value)"></td>
                <td><input type="text" value="${item.Support_7_to_18}" oninput="updateData(${index}, 'Support_7_to_18', this.value)"></td>
                <td><input type="text" value="${item.Clothing_Support}" oninput="updateData(${index}, 'Clothing_Support', this.value)"></td>
                <td><input type="text" value="${item.Frequency}" oninput="updateData(${index}, 'Frequency', this.value)"></td>
                <td><input type="text" value="${item.Educational_Materials}" oninput="updateData(${index}, 'Educational_Materials', this.value)"></td>
                <td><input type="text" value="${item.Education_Support}" oninput="updateData(${index}, 'Education_Support', this.value)"></td>
                <td><input type="text" value="${item.Additional_Support}" oninput="updateData(${index}, 'Additional_Support', this.value)"></td>
                <td><input type="text" value="${item.Other}" oninput="updateData(${index}, 'Other', this.value)"></td>
                <td class="action-buttons">
                    <button class="save-btn" onclick="saveRow(${index})">Saglabāt</button>
                    <button class="delete-btn" onclick="deleteRow(${index})">Dzēst</button>
                </td>
            `;
            tbody.appendChild(row);
        });
    }
    
    // Add a new row
    function addRow() {
        const newRow = {
            Municipality: '',
            Support_Under_7: '',
            Support_7_to_18: '',
            Clothing_Support: '',
            Frequency: '',
            Educational_Materials: '',
            Education_Support: '',
            Additional_Support: '',
            Other: ''
        };
    
        fetch('/data', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(newRow)
        }).then(loadData);
    }
    
    // Update a row
    function saveRow(index) {
        fetch(`/data/${index}`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data[index])
        }).then(() => alert(`Record ${index + 1} saved successfully!`));
    }
    
    // Delete a row
    function deleteRow(index) {
        if (confirm('Are you sure you want to delete this record?')) {
            fetch(`/data/${index}`, { method: 'DELETE' }).then(loadData);
        }
    }
    
    // Update data locally as user types
    function updateData(index, key, value) {
        data[index][key] = value;
    }
    
    // Initial load
    loadData();
    </script>
    

</body>
</html>
